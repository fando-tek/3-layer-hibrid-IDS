## Pembuatan model hibrid 
![Model lapisan 1,2 dan 3](https://github.com/fando-tek/Hybrid-learning-IDS/assets/81504312/c1258df1-9677-4547-9ab6-05784a12da89)\
\
Setelah mendapatkan 96 kombinasi nilai hyperparameter, f1-score dari kombinasi nilai hyperparameter dibandingkan pada setiap lapisan dari masing-masing dataset dengan rasio 1:1, 2:1, 3:1 dan 5:1. Satu lapisan terdiri dari 8 kombinasi hyperparameter yang dibandingkan untuk memilih satu kombinasi nilai hyperparameter yang memiliki nilai f1-score tertinggi seperti pada Gambar diatas.\
\
![model hibrid](https://github.com/fando-tek/Hybrid-learning-IDS/assets/81504312/587da801-672b-4a9e-9038-cf2d80f215be)\
\
Pada tahap ini, dilakukan pembangunan model pada setiap lapisan dari masing-masing dataset (rasio 1:1, 2:1, 3:1 dan 5:1) dengan menggunakan nilai hyperparameter terbaik yang telah didapat dari tahap tuning.\
Pada lapisan satu, digunakan algoritma LSTM untuk klasifikasi dua kelas (biner) dengan label "1" menyatakan kelas serangan dan "0" menyatakan kelas normal. Pada lapisan dua, digunakan algoritma RF untuk klasifikasi dua kelas (biner) dengan label attack menyatakan kelas serangan dan label benign menyatakan kelas normal. Sedangkan pada lapisan tiga, digunakan algoritma RF tetapi diklasifikasikan secara multi kelas dengan label benign, ddos attack hoic, ddos attacks loic http, dos attacks hulk, bot, ftp bruteforce, ssh bruteforce, infilteration, dos attacks slowhttptest, dos attacks goldeneye, dos attacks slowloris, ddos attack loic udp, brute force web, brute force xss, dan sql injection.
Seperti pada Gambar diatas, model lapisan satu mengklasifikasikan aliran data yang masuk sebagai "0" atau "1". Nilai "0" menyatakan data diklassifikasikan sebagai data normal dan nilai "1" menyatakan data serangan. Data normal diklasifikasikan kembali dengan model lapisan dua dan data serangan diklasifikasikan kembali dengan model lapisan tiga. Model lapisan dua hanya mengklasifikasikan ulang data normal hasil dari klasifikasi model lapisan satu, menjadi benign atau attack, benign menyatakan data diklassifikasikan sebagai data normal dan attack meyatakan data serangan. Hal ini bertujuan untuk mengurangi false negative yang dihasilkan dari lapisan satu LSTM . Jika diklasifikasikan sebagai data normal, maka merupakan hasil akhir, dan jika data diklasifikasikan sebagai data serangan maka data tersebut diklasifikasikan lagi dengan model lapisan tiga. Hasil klasifikasi data normal lapisan satu kemudian diperbaharui dengan hasil klasifikasi lapisan dua. Lapisan tiga bertujuan memberikan hasil yang lebih bermanfaat dalam mendeteksi jenis serangan yang terjadi dengan memberikan informasi tentang jenis serangan yang terdeteksi. Selain itu, lapisan ini juga berusaha mencapai keseimbangan antara mengurangi kesalahan deteksi false negative dan false positive dengan mencari trade off yang optimal.
Model lapisan tiga mengklasifikasikan ulang data serangan dari lapisan satu dan lapisan dua menjadi multi kelas benign, ddos attack hoic, ddos attacks loic http, dos attacks hulk, bot, ftp bruteforce, ssh bruteforce, infilteration, dos attacks slowhttptest, dos attacks goldeneye, dos attacks slowloris, ddos attack loic udp, brute force web, brute force xss, dan sql injection. Hasil klasifikasi data serangan lapisan satu dan lapisan dua kemudian diperbahurui dengan hasil klasifikasi lapisan tiga dan merupakan hasil akhir dari model hibrid ini.
Total di ketiga lapisan sebanyak 12 model dibangun menggunakan 12 kombinasi nilai hyperparameter yang didapat dari tahap tuning dan terdapat empat model hibrid yang masing-masing merupakan gabungan tiga model. Keempat model hibrid ini di evaluasi kinerjanya dan hasilnya dibandingkan. Model yang menghasilkan nilai f1-score tertinggi digunakan pada perangkat lunak IDS yang telah dibuat. Perangkat lunak IDS ini hanya untuk simulasi dan bertujuan menguji kinerja model hibrid dalam mendeteksi serangan secara real time.
